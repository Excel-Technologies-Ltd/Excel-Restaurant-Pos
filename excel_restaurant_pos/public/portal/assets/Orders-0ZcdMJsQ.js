var Se=Object.defineProperty,_e=Object.defineProperties;var Pe=Object.getOwnPropertyDescriptors;var pe=Object.getOwnPropertySymbols;var Re=Object.prototype.hasOwnProperty,ke=Object.prototype.propertyIsEnumerable;var me=(r,x,m)=>x in r?Se(r,x,{enumerable:!0,configurable:!0,writable:!0,value:m}):r[x]=m,ce=(r,x)=>{for(var m in x||(x={}))Re.call(x,m)&&me(r,m,x[m]);if(pe)for(var m of pe(x))ke.call(x,m)&&me(r,m,x[m]);return r},oe=(r,x)=>_e(r,Pe(x));import{j as e,h as De,s as se,r as g,i as ge,k as de,H as fe,l as je,$ as Te,F as ee,K as Ie,R as Ae,L as Oe,c as $e,A as be,m as Fe,_ as R,e as Me,Z as Ee,n as Le,o as qe,P as Ue}from"./index-Bxetnfjv.js";const We=({title:r="Data not found"})=>e.jsx("div",{className:"text-gray-500 text-sm h-20 flex items-center",children:r}),He=({selectedOrderDetails:r,setSelectedOrderDetails:x})=>{var m;return e.jsxs(De,{title:"Order Details",isOpen:!0,onClose:()=>x(null),children:[e.jsx("div",{className:"",children:e.jsxs("div",{className:"flex flex-col sm:flex-row justify-start sm:justify-between items-start sm:items-center mb-3 font-medium text-sm",children:[e.jsxs("h2",{className:"flex items-center",children:["Table No : ",e.jsx("p",{className:"font-semibold text-gray-800 ps-1",children:r==null?void 0:r.table})]}),e.jsxs("h2",{className:"flex items-center",children:["Order No : ",e.jsx("p",{className:"font-semibold text-gray-800 ps-1",children:r==null?void 0:r.name})]})]})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table-auto w-full border-collapse min-w-[900px] border rounded-lg overflow-hidden p-5 ",children:[e.jsx("thead",{className:"",children:e.jsxs("tr",{className:"bg-gray-200 text-gray-700 text-left !rounded-t-lg",children:[e.jsx("th",{className:"px-4 py-2 border-b w-44",children:"Item Name"}),e.jsx("th",{className:"px-4 py-2 border-b",children:"Quantity"}),e.jsx("th",{className:"px-4 py-2 border-b",children:"Rate"}),e.jsx("th",{className:"px-4 py-2 border-b",children:"Amount"}),e.jsx("th",{className:"px-4 py-2 border-b",children:" Item Status"}),e.jsx("th",{className:"px-4 py-2 border-b",children:"Delivery Status "})]})}),e.jsx("tbody",{className:"divide-y",children:e.jsx(e.Fragment,{children:(m=r==null?void 0:r.item_list)==null?void 0:m.map((o,T)=>e.jsxs("tr",{className:"",children:[e.jsx(q,{className:"w-44",children:o==null?void 0:o.item}),e.jsx(q,{className:"",children:o==null?void 0:o.qty}),e.jsx(q,{className:"",children:o==null?void 0:o.rate}),e.jsx(q,{className:"",children:o==null?void 0:o.amount}),e.jsx(q,{className:"",children:o!=null&&o.is_parcel?"Takeaway":"Dining"}),e.jsx(q,{className:"",children:e.jsx("div",{className:se("bg-gray-300 rounded-md px-2 py-1 w-fit ",{"bg-green-300/50":o==null?void 0:o.is_ready,"bg-orange-300/50":!(o!=null&&o.is_ready)}),children:o!=null&&o.is_ready?"Ready":"Not Ready"})})]},`${o.name}-${T}`))})})]})})]})},q=({children:r,className:x=""})=>e.jsx("td",{className:se("px-4 py-2 border-b text-sm md:text-[15px]",x),children:r}),ze=({orderId:r,closeModal:x,mutate:m,handleSalesInvoicePrint:o})=>{var ie;const[T,te]=g.useState(0),[u,I]=g.useState([]),[v,V]=g.useState("percentage"),[F,U]=g.useState(""),[W,y]=g.useState(""),[L,k]=g.useState(""),[i,w]=g.useState([]),{startLoading:M,stopLoading:H}=ge(),{data:n}=de("Table Order",r);console.log({order:n,paymentMethods:i});const{updateDoc:A,loading:f}=fe(),{currentUser:ae}=je(),{data:z}=Te("Mode of Payment",{fields:["name"]}),C=z==null?void 0:z.map(s=>s==null?void 0:s.name);console.log({mode_of_payment_list:C});const{data:B}=ee(`excel_restaurant_pos.api.item.get_roles?user=${ae}`),S=(ie=B==null?void 0:B.message)==null?void 0:ie.map(s=>s==null?void 0:s.Role),{data:j}=de("Restaurant Settings","Restaurant Settings",{fields:["*"]}),{call:Z}=Ie("excel_restaurant_pos.api.item.check_coupon_code"),G=parseInt((j==null?void 0:j.tax_rate)||"0")/100,K=20,_=u==null?void 0:u.reduce((s,l)=>s+Number(l.rate)*l.qty,0),J=s=>{const l=u.findIndex(a=>a.name===s);if(l!==-1){const a=[...u];a[l].qty?a[l].qty+=1:a[l].qty=1,I(a)}},X=s=>{const l=u.findIndex(a=>a.name===s);if(l!==-1){const a=[...u];a[l].qty&&a[l].qty>1?a[l].qty-=1:a[l].qty=1,I(a)}},t=s=>{const l=u.filter(a=>a.name!==s);I(l)},p=s=>{const l=s.target.value;if(v==="percentage"){const a=Number(l),d=_*(Number(l)/100);if(l&&(a<0||a>100)){y("Discount must be between 0 and 100.");return}if(d>=_){y("Discount cannot be greater than the total amount.");return}else{y(""),k(l);return}}if(v==="flat")if(l&&Number(l)<0)y("Flat discount cannot be negative.");else if(Number(l)>T){y(`Discount cannot be greater than ${T}.`);return}else if(Number(l)>=_){y("Discount cannot be greater than the total amount.");return}else y(""),k(l);else y(""),k("")},b=s=>{U(s.target.value)},N=()=>{switch(v){case"percentage":return"percentage";case"flat":return"flat amount";case"coupon":return"coupon code";default:return""}},c=s=>{V(s.target.value),k(""),y("")},h=s=>{const l=u.findIndex(a=>a.name===s);if(l!==-1){const a=[...u];a[l].is_parcel=!a[l].is_parcel,I(a)}},E=()=>{const s=i.map(d=>d.method),l=(C==null?void 0:C.filter(d=>!s.includes(d)))||[];if(l.length===0){R.error("All payment methods are already added");return}const a={id:Date.now().toString(),method:l[0],amount:"0"};w([...i,a])},O=s=>{w(i.filter(l=>l.id!==s))},P=(s,l,a)=>{if(l==="method"&&i.some(D=>D.id!==s&&D.method===a)){R.error("This payment method is already added");return}w(i.map(d=>d.id===s?oe(ce({},d),{[l]:a}):d))},ye=()=>{if(i.length===0)return;const s=Q/i.length;w(i.map(l=>oe(ce({},l),{amount:s.toString()})))},ne=()=>i.reduce((s,l)=>s+Number(l.amount),0),Y=()=>Q-ne(),{mutate:Ne}=de("Table Order",r,{fields:["sales_invoice"]}),ve=()=>{const s=(n==null?void 0:n.credit_sales)===1||(n==null?void 0:n.credit_sales)===!0;if(!s&&i.length>0){const a=ne(),d=Y();if(Math.abs(d)>.01){R.error(`Payment total (৳${a.toFixed(2)}) must equal payable amount (৳${Q.toFixed(2)})`);return}}const l={item_list:u,discount:le,discount_type:v,status:"Completed",is_paid:s?0:1,payment_methods:!s&&i.length>0?i:[]};console.log({paymentMethods:i}),console.log({payload:l}),M(),A("Table Order",r,l).then(a=>{a&&(R.success(s?"Credit order updated successfully!":"Order completed successfully!"),x(),m(),console.log("res",a),a!=null&&a.name&&Ne().then(d=>{d!=null&&d.sales_invoice&&o(d==null?void 0:d.sales_invoice)}))}).catch(a=>{R.error("Error updating order status."),console.log("Error updating order status:",a)}).finally(()=>{H()}),console.log({payload:l})},we=()=>{F&&(M(),Z({data:{coupon_code:F}}).then(s=>{var l,a,d,D,xe,ue,he;((l=s==null?void 0:s.message)==null?void 0:l.status)==="success"?(console.log("res",s==null?void 0:s.message),y(""),$=((a=s==null?void 0:s.message)==null?void 0:a.discount_type)==="percentage"?_*Number((D=(d=s==null?void 0:s.message)==null?void 0:d.amount)!=null?D:0)/100:Number((ue=(xe=s==null?void 0:s.message)==null?void 0:xe.amount)!=null?ue:0),k(String($)),U("")):(y((he=s==null?void 0:s.message)==null?void 0:he.message),k(""))}).finally(()=>{H()}))};let $=v==="percentage"?_*Number(L)/100>T?T:_*Number(L)/100:Number(L);const le=$>0?$:n==null?void 0:n.discount,re=(_-le)*G,Q=_-le+re;console.log({orderItems:u}),g.useEffect(()=>{n&&I(n==null?void 0:n.item_list)},[n]),g.useEffect(()=>{n&&i.length===0&&!((n==null?void 0:n.credit_sales)===1||(n==null?void 0:n.credit_sales)===!0)&&w([{id:Date.now().toString(),method:"Cash",amount:"0"}])},[n,i.length]),g.useEffect(()=>{const s=l=>{var a;if(j!=null&&j.discount_allocation){const d=(a=j==null?void 0:j.discount_allocation)==null?void 0:a.find(D=>(D==null?void 0:D.role)===l);if(d&&(d==null?void 0:d.amount)>0)return te(d==null?void 0:d.amount),!0}return!1};S!=null&&S.includes("Restaurant Manager")&&s("Restaurant Manager")||S!=null&&S.includes("Restaurant Cashier")&&s("Restaurant Cashier")||S!=null&&S.includes("Restaurant Waiter")&&s("Restaurant Waiter")},[S,j==null?void 0:j.discount_allocation]);const Ce=s=>{const l=i.filter(a=>a.id!==s).map(a=>a.method);return(C==null?void 0:C.filter(a=>!l.includes(a)))||[]};return e.jsx("div",{className:"fixed inset-0 flex justify-center items-center bg-black bg-opacity-50 p-2",style:{zIndex:999},children:e.jsxs("div",{className:"bg-white p-2 px-4 pb-3 rounded-md shadow-lg w-96 md:w-[600px] max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-3",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-base md:text-lg font-semibold mb-2",children:"Cart Summary"}),((n==null?void 0:n.credit_sales)===1||(n==null?void 0:n.credit_sales)===!0)&&e.jsx("span",{className:"text-xs bg-orange-100 text-orange-800 px-2 py-1 rounded-full",children:"Credit Sale"})]}),e.jsx("button",{onClick:x,className:"text-red-500 text-xs md:text-sm border rounded-md p-1",children:e.jsx(Ae,{})})]}),(u==null?void 0:u.length)>0?e.jsx("div",{className:"text-xs md:text-sm",children:u==null?void 0:u.map(s=>{var l,a;return e.jsx("div",{className:"accordion mb-1",children:e.jsx("div",{className:"border rounded-md p-2",children:e.jsxs("div",{className:"flex justify-between items-center transition font-medium",children:[e.jsxs("div",{className:"block w-1/3",children:[e.jsxs("p",{title:s==null?void 0:s.item,className:"font-semibold truncate",children:[((l=s==null?void 0:s.item)!=null?l:"").substring(0,K),((a=s==null?void 0:s.item_name)==null?void 0:a.length)>K?"...":""]}),e.jsxs("p",{className:"font-semibold mt-1",children:["৳",s==null?void 0:s.rate]}),e.jsx("div",{className:"flex items-center space-x-2 mt-1",children:e.jsxs("label",{className:"flex items-center text-xs",children:[e.jsx("input",{type:"checkbox",checked:s==null?void 0:s.is_parcel,className:"mr-2",onChange:()=>h(s==null?void 0:s.name)}),"Takeaway"]})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"flex items-center rounded-md h-fit border w-full",children:[e.jsx("button",{onClick:()=>X(s==null?void 0:s.name),className:"px-2 rounded-md rounded-e-none text-xs bg-gray-200 h-fit py-1.5",children:e.jsx(Oe,{className:"text-xs"})}),e.jsx("span",{className:"px-2 text-xs h-full flex items-center",children:s==null?void 0:s.qty}),e.jsx("button",{onClick:()=>J(s==null?void 0:s.name),className:"px-2 rounded-md rounded-s-none bg-gray-200 h-fit py-1.5",children:e.jsx($e,{className:"text-xs"})})]}),e.jsx("button",{onClick:()=>t(s==null?void 0:s.name),className:"text-red-500 px-2 rounded-md text-xs bg-gray-200 h-fit py-1.5 border",children:e.jsx(be,{})})]})]})})},s==null?void 0:s.name)})}):e.jsx("div",{className:"flex items-center justify-center min-h-28 border border-borderColor rounded-md text-xs",children:"No item in cart"}),e.jsxs("div",{className:"py-4 flex flex-col items-start",children:[e.jsx("h3",{className:"font-semibold text-sm mb-1",children:"Discount"}),(n==null?void 0:n.discount)>0&&e.jsxs("p",{className:"text-xs text-green-500",children:["Applied: ৳",n==null?void 0:n.discount]}),e.jsxs("div",{className:"flex gap-2 w-full text-sm relative",children:[e.jsxs("select",{value:v,onChange:c,className:"border rounded-md p-1 focus:outline-none px-2",children:[e.jsx("option",{value:"percentage",children:"Percentage"}),e.jsx("option",{value:"flat",children:"Flat Amount"}),e.jsx("option",{value:"coupon",children:"Coupon"})]}),e.jsx("input",{type:v==="coupon"?"text":"number",value:v==="coupon"?F:L,onChange:v==="coupon"?b:p,className:`border rounded-md p-1 focus:outline-none px-3 w-full ${W?"border-red-500":""}`,placeholder:`Enter ${N()}`}),W&&e.jsx("p",{className:"text-red-500 text-xs right-0 -bottom-5 pt-2 absolute",children:W}),v==="coupon"&&e.jsx("button",{onClick:we,className:"absolute right-3 top-1  px-2 py-1 bg-blue-500 text-xs text-white rounded-md hover:bg-blue-600",children:"Verify"})]})]}),e.jsxs("div",{className:"p-3 border rounded-md mt-5",children:[e.jsxs("div",{className:"flex justify-between text-xs md:text-sm",children:[e.jsx("h1",{children:"Subtotal"}),e.jsxs("h1",{children:["৳",_.toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between text-xs md:text-sm mt-2",children:[e.jsx("h1",{children:"Discount"}),e.jsxs("h1",{children:["৳",$>0?$==null?void 0:$.toFixed(2):n==null?void 0:n.discount]})]}),e.jsxs("div",{className:"flex justify-between text-xs md:text-sm mt-2",children:[e.jsxs("h1",{children:["Tax (",G*100,"%)"]}),e.jsxs("h1",{children:["৳",re.toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between text-xs md:text-sm font-semibold mt-2",children:[e.jsx("h1",{children:"Payable Amount"}),e.jsxs("h1",{children:["৳",Q||(n==null?void 0:n.total_amount)]})]})]}),!((n==null?void 0:n.credit_sales)===1||(n==null?void 0:n.credit_sales)===!0)&&e.jsxs("div",{className:"mt-5",children:[e.jsxs("div",{className:"xs:flex justify-between items-center mb-3",children:[e.jsx("h3",{className:"font-semibold text-sm mb-2 sm:mb-0",children:"Payment Methods"}),e.jsxs("div",{className:"flex gap-2 justify-end",children:[e.jsx("button",{onClick:ye,className:"text-xs bg-blue-500 text-white px-2 py-1 rounded hover:bg-blue-600",disabled:i.length===0,children:"Distribute Evenly"}),e.jsx("button",{onClick:E,className:"text-xs bg-green-500 text-white px-2 py-1 rounded hover:bg-green-600 disabled:opacity-50 disabled:cursor-not-allowed",disabled:i.length>=((C==null?void 0:C.length)||0),children:"Add Payment"})]})]}),(i==null?void 0:i.length)>0&&e.jsxs("div",{className:"border rounded-md p-3",children:[e.jsx("div",{className:"space-y-2",children:i==null?void 0:i.map(s=>{var l;return e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center gap-2 border-b pb-2 last:border-0",children:[e.jsx("select",{value:s.method,onChange:a=>P(s.id,"method",a.target.value),className:"text-xs border rounded px-2 py-1 w-full md:flex-1 focus:outline-none",children:(l=Ce(s.id))==null?void 0:l.map(a=>e.jsx("option",{value:a,children:a},a))}),e.jsxs("div",{className:"flex flex-1 items-center gap-2 w-full",children:[e.jsx("input",{type:"text",value:s.reference||"",onChange:a=>P(s.id,"reference",a.target.value),className:"text-xs border rounded px-2 py-1.5 flex-1 md:w-40 focus:outline-none",placeholder:"Type Reference Number"}),e.jsx("input",{type:"number",min:0,value:s.amount.toString(),onChange:a=>P(s.id,"amount",a.target.value),className:"text-xs border rounded px-2 py-1.5 w-20 focus:outline-none",placeholder:"Amount"}),e.jsx("button",{onClick:()=>O(s.id),className:"text-red-500 text-xs px-2 py-1.5 border rounded hover:bg-red-50 flex-shrink-0",children:e.jsx(be,{})})]})]},s.id)})}),e.jsxs("div",{className:"mt-3 pt-2 border-t",children:[e.jsxs("div",{className:"flex justify-between text-xs",children:[e.jsx("span",{children:"Total Payment:"}),e.jsxs("span",{className:"font-semibold",children:["৳",ne().toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between text-xs mt-1",children:[e.jsx("span",{children:"Remaining:"}),e.jsxs("span",{className:`font-semibold ${Y()>0?"text-red-500":Y()<0?"text-green-500":"text-gray-500"}`,children:["৳",Y().toFixed(2)]})]})]})]})]}),e.jsxs("div",{className:"flex justify-between gap-3 ",children:[e.jsx("button",{onClick:x,className:"bg-primaryColor text-white w-full p-2 rounded-md mt-3 text-sm",children:"Cancel"}),e.jsxs("button",{onClick:ve,className:"bg-primaryColor text-white w-full p-2 rounded-md mt-3 text-sm flex items-center justify-center gap-1.5",disabled:f,children:[f&&e.jsx(Fe,{className:"animate-spin"}),f?"Loading...":(n==null?void 0:n.credit_sales)===1||(n==null?void 0:n.credit_sales)===!0?"Update Credit Order":"Checkout"]})]})]})})},Qe=()=>{var K,_,J,X;const{currentUser:r}=je(),[x,m]=g.useState(!1),[o,T]=g.useState("");g.useState(0);const{startLoading:te,stopLoading:u}=ge(),[I,v]=g.useState(null),[V,F]=g.useState(1),[U,W]=g.useState(10),y=t=>{F(t)},L=t=>{W(t),F(1)},{data:k}=ee(`excel_restaurant_pos.api.item.get_roles?user=${r}`),i=(K=k==null?void 0:k.message)==null?void 0:K.map(t=>t==null?void 0:t.Role),w=[{id:1,state:"Order Placed",action:"Accept",nextState:"Work in progress",allowed:"Restaurant Waiter"},{id:2,state:"Order Placed",action:"Reject",nextState:"Canceled",allowed:"Restaurant Waiter"},{id:4,state:"Work in progress",action:"Reject",nextState:"Canceled",allowed:"Restaurant Chef"},{id:5,state:"Ready to Serve",action:"Pay Now",nextState:"Completed",allowed:"Restaurant Manager"},{id:6,state:"Ready to Serve",action:"Pay Now",nextState:"Completed",allowed:"Restaurant Cashier"}],[M,H]=g.useState(""),{data:n,mutate:A}=ee(`excel_restaurant_pos.api.item.get_order_list?status=${M?encodeURIComponent(M):""}&page=${V}&page_size=${U}`,["*"]),f=(_=n==null?void 0:n.message)==null?void 0:_.data,ae=(t,p)=>w==null?void 0:w.filter(b=>(b==null?void 0:b.state)===t&&(p==null?void 0:p.some(N=>(b==null?void 0:b.allowed)===N))),{updateDoc:z}=fe(),C=(t,p,b,N)=>{p==="Ready to Serve"?(T(t),m(!0)):B(t,p,b,N)},B=(t,p,b,N)=>{const c=w==null?void 0:w.find(h=>(h==null?void 0:h.state)===p&&(b==null?void 0:b.includes(h==null?void 0:h.allowed))&&(h==null?void 0:h.action)===N);if(c){const h=c.nextState,E={status:h};h==="Completed"&&(E.docstatus=1),te(),z("Table Order",t,E).then(O=>{O&&(R.success("Order status updated successfully!"),A())}).catch(O=>{R.error("Error updating order status."),console.log("Error updating order status:",O)}).finally(()=>{u()})}else R.error("Invalid transition for the current state and role.")},S=t=>{const p=["bg-white ","bg-gray-100"];return p[t%p.length]};Me("Table Order",()=>{A(),console.log("Order List Updated")}),Ee("Table Order","on_update",t=>{A(),console.log("Event data:",t)}),g.useEffect(()=>{A()},[M,A]);const{mutate:j}=ee("excel_restaurant_pos.api.print.get_print_format_sales_invoice",{swr:{revalidateOnFocus:!1,revalidateOnReconnect:!1,revalidateOnMount:!1,revalidateIfStale:!1}}),Z=t=>{try{const p="Sales Invoice",b=t;let N="Standard";j().then(c=>{N=c==null?void 0:c.message;const h=`/api/method/frappe.utils.print_format.download_pdf?doctype=${encodeURIComponent(p)}&name=${encodeURIComponent(b)}&format=${encodeURIComponent(N)}&no_letterhead=1&letterhead=No%20Letterhead&settings=%7B%7D&_lang=en`;window.open(h,"_blank"),R.success("Opening print preview...")}),window.open(printUrl,"_blank"),R.success("Opening print preview...")}catch(p){R.error("Error opening print preview"),console.error("Print error:",p)}},G=()=>["Order Placed","Work in progress","Ready to Serve","Completed","Canceled"].map(t=>e.jsx("option",{value:t,children:t}));return console.log({orders:f}),e.jsxs("div",{className:"p-6 rounded-lg",children:[e.jsx("h2",{className:"font-semibold text-2xl text-gray-800 mb-6",children:"Orders"}),e.jsxs("div",{className:"mb-4 flex gap-2 md:gap-4",children:[e.jsx("div",{className:"w-60",children:e.jsxs(Le,{isHideSelect:!0,value:M||"",onChange:t=>{H(t.target.value),F(1)},children:[e.jsx("option",{value:"",children:"All Orders"}),G()]})}),e.jsx("button",{onClick:()=>H(""),className:"bg-gray-100 border border-gray-300 hover:bg-gray-200 text-gray-800 py-1 2xl:py-1.5 px-4 rounded transition-all duration-300",children:"Reset"})]}),e.jsxs("div",{className:"bg-white shadow-sm p-3 rounded-lg",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table-auto w-full border-collapse min-w-[1380px] border rounded-lg overflow-hidden p-5 ",children:[e.jsx("thead",{className:"",children:e.jsxs("tr",{className:"bg-gray-200 text-gray-700 text-left !rounded-t-lg",children:[e.jsx("th",{className:"px-4 py-2 border-b w-36",children:"Order ID"}),e.jsx("th",{className:"px-4 py-2 border-b",children:"Table"}),e.jsx("th",{className:"px-4 py-2 border-b w-52",children:"Status"}),e.jsx("th",{className:"px-4 py-2 border-b",children:"Total Amount"}),e.jsx("th",{className:"px-4 py-2 border-b w-44",children:"Item Name"}),e.jsx("th",{className:"px-4 py-2 border-b",children:"Quantity"}),e.jsx("th",{className:"px-4 py-2 border-b",children:"Rate"}),e.jsx("th",{className:"px-4 py-2 border-b",children:"Amount"}),e.jsx("th",{className:"px-4 py-2 border-b",children:" Item Status"}),e.jsx("th",{className:"px-4 py-2 border-b w-40",children:"Delivery Status "}),e.jsx("th",{className:"px-4 py-2 border-b",children:"Action"})]})}),e.jsxs("tbody",{className:"divide-y",children:[(f==null?void 0:f.length)===0&&e.jsx(We,{}),(f==null?void 0:f.length)>0&&(f==null?void 0:f.map((t,p)=>{var N;const b=S(p);return e.jsx(qe.Fragment,{children:(N=t==null?void 0:t.item_list)==null?void 0:N.map((c,h)=>{var E,O;return e.jsxs("tr",{className:`${b} `,children:[h===0&&e.jsxs(e.Fragment,{children:[e.jsx("td",{className:"px-4 py-2 border-b w-36 text-start",rowSpan:t.item_list.length,children:t==null?void 0:t.name}),e.jsx("td",{className:"px-4 py-2 border-b w-44",rowSpan:t.item_list.length,children:(t==null?void 0:t.table)||"Takeaway Order"}),e.jsx("td",{className:"px-4 py-2 border-b w-52",rowSpan:t.item_list.length,children:e.jsx("div",{className:se("bg-gray-300 rounded-md px-2 py-1 w-fit border",{"bg-green-300/40 border-green-300":(t==null?void 0:t.status)==="Completed","bg-orange-300/40 border-orange-200":(t==null?void 0:t.status)!=="Completed","bg-red-300/40 border-red-300":(t==null?void 0:t.status)==="Canceled","bg-yellow-300/40 border-yellow-300":(t==null?void 0:t.status)==="Work in progress","bg-teal-300/40 border-teal-300":(t==null?void 0:t.status)==="Order Placed"}),children:t==null?void 0:t.status})}),e.jsx("td",{className:"px-4 py-2 border-b",rowSpan:t.item_list.length,children:(E=t==null?void 0:t.total_amount)==null?void 0:E.toFixed(2)})]}),e.jsx("td",{className:"px-4 py-2 border-b w-44",children:c==null?void 0:c.item}),e.jsx("td",{className:"px-4 py-2 border-b",children:c==null?void 0:c.qty}),e.jsx("td",{className:"px-4 py-2 border-b",children:c==null?void 0:c.rate}),e.jsx("td",{className:"px-4 py-2 border-b",children:c==null?void 0:c.amount}),e.jsx("td",{className:"px-4 py-2 border-b",children:c!=null&&c.is_parcel?"Takeaway":"Dining"}),e.jsx("td",{className:"px-4 py-2 border-b w-40",children:e.jsx("div",{className:se("bg-gray-300 rounded-md px-2 py-1 w-fit border",{"bg-green-300/50 border-green-300":c==null?void 0:c.is_ready,"bg-orange-300/50 border-orange-300":!(c!=null&&c.is_ready)}),children:c!=null&&c.is_ready?"Ready":"Not Ready"})}),h===0?e.jsxs("td",{className:"px-4 py-2 border-b flex gap-3 border-b-0",rowSpan:t.item_list.length,children:[(O=ae(t==null?void 0:t.status,i).slice(0,1))==null?void 0:O.map(P=>e.jsx("button",{onClick:()=>C(t==null?void 0:t.name,t==null?void 0:t.status,i,P==null?void 0:P.action),className:"bg-primaryColor text-white py-1.5 px-4 rounded whitespace-nowrap",children:P==null?void 0:P.action},P.action)),(t==null?void 0:t.status)==="Completed"&&e.jsx("button",{onClick:()=>Z(t==null?void 0:t.sales_invoice),className:"bg-primaryColor text-white py-1.5 px-4 rounded whitespace-nowrap",children:"Print"})]}):e.jsx("td",{className:"px-4 py-2 border-b flex gap-3 border-b-0",rowSpan:t.item_list.length})]},`${t.name}-${h}`)})},t.name)}))]})]})}),e.jsx(Ue,{currentPage:V,totalPages:(J=n==null?void 0:n.message)==null?void 0:J.totalPages,totalDataCount:(X=n==null?void 0:n.message)==null?void 0:X.totalDataCount,itemsPerPage:U,onPageChange:y,onItemsPerPageChange:L})]}),x&&e.jsx("div",{className:"bg-white p-6 rounded-lg w-96",children:o&&e.jsx(ze,{orderId:o,closeModal:()=>m(!1),mutate:A,handleSalesInvoicePrint:Z})}),I&&e.jsx(He,{selectedOrderDetails:I,setSelectedOrderDetails:v})]})};export{Qe as default};
