import{f as w,F as h,e as R,H as y,j as s}from"./index-DMV5bGi4.js";const C=()=>{const{currentUser:f}=w(),{data:d}=h("excel_restaurant_pos.api.item.get_roles"),u=d==null?void 0:d.message;console.log(f);const c=[{id:1,state:"Order Placed",action:"Accept",nextState:"Work in progress",allowed:"Restaurant Waiter"},{id:2,state:"Order Placed",action:"Reject",nextState:"Canceled",allowed:"Restaurant Waiter"},{id:3,state:"Work in progress",action:"Ready for Pickup",nextState:"Ready for Pickup",allowed:"Restaurant Chef"},{id:3,state:"Work in progress",action:"Reject",nextState:"Canceled",allowed:"Restaurant Chef"},{id:4,state:"Ready for Pickup",action:"Completed",nextState:"Completed",allowed:"Restaurant Manager"}],{data:o,mutate:g}=h("excel_restaurant_pos.api.item.get_order_list",["*"]),n=o==null?void 0:o.message;console.log(n);const j=(e,l)=>c.filter(t=>(t==null?void 0:t.state)===e&&(l==null?void 0:l.includes(t==null?void 0:t.allowed)));R("Table Order",e=>{console.log("Event data:",e)});const{updateDoc:N}=y(),b=(e,l,t,x)=>{const m=c==null?void 0:c.find(a=>(a==null?void 0:a.state)===l&&(t==null?void 0:t.includes(a==null?void 0:a.allowed))&&(a==null?void 0:a.action)===x);if(m){const a=m.nextState,p={status:a};a==="Completed"&&(p.docstatus=1),N("Table Order",e,p).then(i=>{i&&(console.log("Order status updated successfully:",i),g())}).catch(i=>{console.log("Error updating order status:",i)})}else console.log("Invalid transition for the current state and role.")};return s.jsxs("div",{className:"p-4",children:[s.jsx("h2",{className:"font-semibold text-xl mb-4",children:"Orders"}),s.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:n==null?void 0:n.map(e=>{var l;return s.jsxs("div",{className:"bg-white shadow-lg rounded-md p-4",children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("h3",{className:"text-xl font-semibold",children:e==null?void 0:e.name}),s.jsx("div",{className:"text-sm text-gray-500",children:e.table})]}),s.jsxs("div",{className:"mt-2 text-sm",children:[s.jsxs("p",{className:"font-semibold",children:["Total: ৳",e==null?void 0:e.total_amount]}),s.jsxs("p",{className:"font-semibold",children:["Status: ",e==null?void 0:e.status]})]}),s.jsxs("div",{className:"mt-4",children:[s.jsx("h4",{className:"font-semibold mb-2",children:"Items:"}),s.jsx("ul",{className:"list-none space-y-2",children:(l=e.item_list)==null?void 0:l.map((t,x)=>s.jsxs("li",{className:"flex justify-between text-xs",children:[s.jsx("span",{children:t==null?void 0:t.item}),s.jsxs("span",{children:["৳",t==null?void 0:t.rate," x ",t==null?void 0:t.qty]})]},x))})]}),s.jsx("div",{className:"mt-4 w-fit flex h-fit gap-4",children:j(e==null?void 0:e.status,u).map(t=>s.jsx("button",{onClick:()=>b(e==null?void 0:e.name,e==null?void 0:e.status,u,t==null?void 0:t.action),className:"w-full bg-primaryColor text-white py-1.5 px-4 rounded",children:t.action},t.action))})]},e.name)})})]})};export{C as default};
